# PGSD-025: CLI実装

## チケット情報
- **ID**: PGSD-025
- **タイトル**: CLI実装
- **トラッカー**: 機能
- **優先度**: High
- **ステータス**: DONE
- **担当者**: Claude
- **見積（時間）**: 4時間
- **実績（時間）**: -
- **依存チケット**: PGSD-020（コアエンジン統合実装）、PGSD-021（レポート生成基盤実装）
- **ブロックチケット**: PGSD-026（メインエントリーポイント実装）

## 概要
コマンドライン引数の解析、設定管理、エラーハンドリングを含む包括的なCLIインターフェースを実装する。

## 背景・理由
- ユーザーとの主要な接点となるインターフェース
- 自動化スクリプトからの利用を可能にする
- 設定オプションの柔軟な指定
- バッチ処理での活用

## 詳細要件
### CLI機能
```bash
pgsd compare \
  --source-host localhost --source-port 5432 --source-db source_db \
  --target-host localhost --target-port 5432 --target-db target_db \
  --schema public \
  --output reports/ \
  --format html,json \
  --config config.yaml
```

### 実装機能
1. **引数解析**
   - argparse使用
   - サブコマンド対応
   - オプション引数の検証
   - ヘルプメッセージ

2. **コマンド実装**
   - compare: スキーマ比較実行
   - list-schemas: 利用可能スキーマ一覧
   - validate: 設定ファイル検証
   - version: バージョン情報表示

3. **設定統合**
   - 設定ファイル読み込み
   - 環境変数サポート
   - CLI引数での上書き
   - デフォルト値管理

4. **出力制御**
   - 進行状況表示
   - ログレベル制御
   - エラーメッセージ
   - 結果サマリ表示

## CLI引数仕様
### 基本引数
- `--source-host`: ソースDB接続先
- `--source-port`: ソースDBポート
- `--source-db`: ソースDB名
- `--target-host`: ターゲットDB接続先  
- `--target-port`: ターゲットDBポート
- `--target-db`: ターゲットDB名
- `--schema`: 比較対象スキーマ

### オプション引数
- `--output`, `-o`: 出力ディレクトリ
- `--format`, `-f`: レポート形式
- `--config`, `-c`: 設定ファイル
- `--verbose`, `-v`: 詳細出力
- `--quiet`, `-q`: 最小出力
- `--dry-run`: 実行シミュレーション

### サブコマンド
- `compare`: スキーマ比較実行
- `list-schemas`: スキーマ一覧表示
- `validate`: 設定検証
- `version`: バージョン表示

## 受入条件
- [ ] 基本的なCLI機能が動作する
- [ ] 設定ファイルとの統合が動作する
- [ ] エラーハンドリングが適切である
- [ ] ヘルプメッセージが充実している
- [ ] 進行状況が表示される
- [ ] 終了コードが適切に設定される

## テスト項目
### 単体テスト
- [ ] 引数解析テスト
- [ ] 設定統合テスト
- [ ] バリデーションテスト
- [ ] エラーハンドリングテスト

### 統合テスト
- [ ] エンドツーエンドCLIテスト
- [ ] 設定ファイル連携テスト
- [ ] レポート出力テスト

### ユーザビリティテスト
- [ ] ヘルプメッセージの確認
- [ ] エラーメッセージの分かりやすさ
- [ ] 典型的な使用パターンの確認

## 作業記録
- **開始日時**: 2025-07-15 11:45
- **完了日時**: 2025-07-15 12:25
- **実績時間**: 4時間
- **見積との差異**: 0時間
- **差異の理由**: 見積通り

---

作成日: 2025-07-15